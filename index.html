<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Kru Pai Classroom ‚Äî Adjective Meaning Game (40) ‚Ä¢ Pink Theme</title>
<style>
  :root{
    --bg1:#fff5f8;
    --bg2:#ffe6ef;
    --ink:#4a1633;
    --muted:#a85574;
    --primary:#d81b60;
    --accent:#f06292;
    --good:#2e7d32;
    --bad:#c62828;
    --card:#ffffff;
    --shadow:0 10px 30px rgba(216,27,96,.12);
    --radius:18px;
  }
  *{box-sizing:border-box}
  body{margin:0;font-family:'Segoe UI',system-ui,-apple-system,Arial,sans-serif;color:var(--ink);
       background:linear-gradient(180deg,var(--bg1),var(--bg2) 60%);min-height:100vh;}
  header{display:flex;align-items:center;justify-content:space-between;padding:14px 18px;
         position:sticky;top:0;z-index:5;background:rgba(255,245,248,.75);
         backdrop-filter:saturate(1.2) blur(6px);border-bottom:1px solid #ffd1df;}
  .brand{display:flex;gap:10px;align-items:center;font-weight:800;color:var(--primary);}
  .brand .mark{width:38px;height:38px;border-radius:12px;background:var(--primary);
               display:grid;place-items:center;color:#fff;box-shadow:var(--shadow);font-weight:900;}
  .container{max-width:980px;margin:26px auto;padding:0 16px 60px;}
  .card{background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow);padding:22px;margin:18px 0;}
  h1,h2,h3{margin:8px 0 14px} h1{font-size:clamp(24px,3.2vw,34px);color:var(--primary)}
  h2{font-size:clamp(20px,2.4vw,26px);color:var(--accent)} p{line-height:1.6}
  label{display:block;margin:10px 0;padding:12px 14px;border:1.5px solid #ffd1df;border-radius:12px;cursor:pointer;font-size:18px}
  input[type="radio"]{accent-color:var(--accent);transform:scale(1.2);margin-right:8px}
  .btn{display:inline-flex;align-items:center;justify-content:center;gap:8px;padding:12px 18px;border-radius:14px;border:0;
       background:var(--primary);color:#fff;font-weight:700;box-shadow:0 8px 18px rgba(216,27,96,.18);cursor:pointer;transition:transform .05s ease;font-size:16px}
  .btn:active{transform:translateY(1px)} .btn.secondary{background:var(--accent)} .btn.ghost{background:#fff;color:var(--primary);border:2px solid #ffd1df}
  .btn.danger{background:var(--bad)} .btn.good{background:var(--good)}
  .toolbar{display:flex;gap:10px;flex-wrap:wrap}
  .muted{color:var(--muted);font-size:14px} .big{font-size:20px} .center{text-align:center}
  .hidden{display:none !important}
  .badge{display:inline-flex;align-items:center;gap:8px;background:#ffe6ef;border:1px solid #ffd1df;color:var(--primary);
         padding:8px 12px;border-radius:999px;font-weight:600;}
  .scoreboard{display:flex;align-items:center;justify-content:space-between;gap:12px;background:#ffe6ef;border:1px solid #ffd1df;border-radius:14px;
              padding:10px 14px;margin-bottom:10px;font-weight:700;color:var(--primary)}
  .question{font-size:22px;margin-bottom:8px}
  .footer-note{text-align:center;color:#c77e96;margin-top:22px;font-size:14px}
  .grid-2{display:grid;grid-template-columns:1fr;gap:16px}
  @media (min-width:860px){.grid-2{grid-template-columns:1.1fr .9fr}}
  .list{margin:0;padding-left:18px} .list li{margin:6px 0}
  table{width:100%;border-collapse:separate;border-spacing:0;overflow:hidden;border-radius:14px;border:1px solid #ffd1df}
  th,td{padding:10px 12px;border-bottom:1px solid #ffe6ef}
  th{background:#ffe6ef;color:var(--primary);text-align:left}
  tr:last-child td{border-bottom:none}
  .vocab-grid{display:grid;grid-template-columns:1fr;gap:16px}
  @media(min-width:860px){.vocab-grid{grid-template-columns:1fr 1fr}}
  .timer{
    display:inline-flex;align-items:center;gap:6px;padding:6px 10px;border-radius:999px;
    background:#fff;border:2px solid #ffd1df;color:var(--primary);font-weight:800;
  }
  .timer.low{border-color:#f9a8d4;color:#b91c1c}
</style>
</head>
<body>
<header>
  <div class="brand">
    <div class="mark">KP</div>
    <div>
      Kru Pai Classroom<br/><span class="muted">Adjective Meaning ‚Äî Pink Edition üå∏</span>
    </div>
  </div>
  <div class="badge">‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏™‡∏µ‡∏¢‡∏á ‚Ä¢ ‡∏à‡∏±‡∏ö‡πÄ‡∏ß‡∏•‡∏≤ 7 ‡∏ß‡∏¥/‡∏Ç‡πâ‡∏≠</div>
</header>

<div class="container">

  <!-- START -->
  <section id="screen-start" class="card">
    <h1 class="center">üå∏ ‡πÄ‡∏Å‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢‡∏Ñ‡∏≥‡∏Ñ‡∏∏‡∏ì‡∏®‡∏±‡∏û‡∏ó‡πå (40 ‡∏Ñ‡∏≥) üå∏</h1>
    <p class="center big">‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠ ‚Üí ‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå 40 ‡∏Ñ‡∏≥ ‚Üí ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏° 40 ‡∏Ç‡πâ‡∏≠ (‚è±Ô∏è 7 ‡∏ß‡∏¥/‡∏Ç‡πâ‡∏≠)</p>
    <div class="card">
      <label>‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô
        <input id="playerName" type="text" placeholder="‡πÄ‡∏ä‡πà‡∏ô Nam, Mint, Top" style="width:100%;padding:12px 14px;margin-top:6px;border-radius:12px;border:1.5px solid #ffd1df;font-size:18px">
      </label>
      <div class="toolbar">
        <button class="btn secondary" onclick="goVocab()">üß† ‡πÑ‡∏õ‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå (40 ‡∏Ñ‡∏≥)</button>
      </div>
    </div>
    <div class="footer-note">¬© Kru Pai Classroom ‚Ä¢ Pink Theme ‚Ä¢ ‡∏ó‡∏≥‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏Å üíñ</div>
  </section>

  <!-- VOCAB GATE -->
  <section id="screen-vocab" class="card hidden">
    <h2>üß† Vocabulary Gate ‚Äî ‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå‡∏ó‡∏µ‡πà‡∏Ñ‡∏ß‡∏£‡∏£‡∏π‡πâ (40 ‡∏Ñ‡∏≥)</h2>
    <p class="muted">*‡∏Ñ‡∏≥‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ó‡∏¢‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡∏ñ‡∏≠‡∏î‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÇ‡∏î‡∏¢‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡∏≠‡∏≠‡∏Å‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏á‡πà‡∏≤‡∏¢‡∏Ç‡∏∂‡πâ‡∏ô</p>
    <div class="vocab-grid">
      <div class="card">
        <table>
          <thead><tr><th>English</th><th>‡∏Ñ‡∏≥‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ó‡∏¢</th><th>‡∏Ñ‡∏≥‡πÅ‡∏õ‡∏•</th></tr></thead>
          <tbody id="vocabCol1"></tbody>
        </table>
      </div>
      <div class="card">
        <table>
          <thead><tr><th>English</th><th>‡∏Ñ‡∏≥‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ó‡∏¢</th><th>‡∏Ñ‡∏≥‡πÅ‡∏õ‡∏•</th></tr></thead>
          <tbody id="vocabCol2"></tbody>
        </table>
      </div>
    </div>
    <div class="toolbar" style="margin-top:10px">
      <button class="btn ghost" onclick="backToStart()">‚¨ÖÔ∏è ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö</button>
      <button class="btn" onclick="goRules()">üìã ‡πÑ‡∏õ‡∏î‡∏π‡∏Å‡∏ï‡∏¥‡∏Å‡∏≤‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏•‡πà‡∏ô</button>
    </div>
  </section>

  <!-- RULES -->
  <section id="screen-rules" class="card hidden">
    <h2>üìã ‡∏Å‡∏ï‡∏¥‡∏Å‡∏≤‡πÄ‡∏Å‡∏°‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢</h2>
    <ul class="list">
      <li>‡πÄ‡∏Å‡∏°‡∏°‡∏µ <b>40 ‡∏Ç‡πâ‡∏≠</b> ‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏µ‡πÄ‡∏ß‡∏•‡∏≤ <b>7 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</b></li>
      <li>‡∏≠‡πà‡∏≤‡∏ô‡∏Ñ‡∏≥‡∏Ñ‡∏∏‡∏ì‡∏®‡∏±‡∏û‡∏ó‡πå‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏© ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å <b>‡∏Ñ‡∏≥‡πÅ‡∏õ‡∏•‡πÑ‡∏ó‡∏¢‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á</b></li>
      <li>‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏®‡∏π‡∏ô‡∏¢‡πå = ‡∏ô‡∏±‡∏ö‡∏ß‡πà‡∏≤ <b>‡∏ú‡∏¥‡∏î</b> ‡πÅ‡∏•‡∏∞‡πÑ‡∏õ‡∏Ç‡πâ‡∏≠‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</li>
      <li>‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏ú‡πà‡∏≤‡∏ô: <b>80%</b> (‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 32 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô)</li>
      <li>‡∏Å‡∏ï‡∏¥‡∏Å‡∏≤‡∏î‡∏π‡πÄ‡∏â‡∏•‡∏¢: <b>‡∏ú‡πà‡∏≤‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å</b> ‚Üí ‡∏î‡∏π‡πÄ‡∏â‡∏•‡∏¢‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢ / ‡∏ñ‡πâ‡∏≤ <b>‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô</b> ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏•‡πà‡∏ô‡∏≠‡∏µ‡∏Å‡∏£‡∏≠‡∏ö‡∏Å‡πà‡∏≠‡∏ô‡∏ñ‡∏∂‡∏á‡∏à‡∏∞‡∏î‡∏π‡πÄ‡∏â‡∏•‡∏¢‡πÑ‡∏î‡πâ</li>
    </ul>
    <div class="toolbar">
      <button class="btn ghost" onclick="backToStart()">‚¨ÖÔ∏è ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö</button>
      <button class="btn" onclick="startGame()">‚ñ∂Ô∏è ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏•‡πà‡∏ô 40 ‡∏Ç‡πâ‡∏≠</button>
    </div>
  </section>

  <!-- QUIZ -->
  <section id="screen-quiz" class="hidden">
    <div class="scoreboard">
      <div>‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô: <span id="playerLabel">-</span></div>
      <div>‡∏Ç‡πâ‡∏≠: <span id="qIndex">1</span>/<span id="qTotal">40</span></div>
      <div class="timer" id="timer">‚è±Ô∏è 7</div>
    </div>
    <div class="card">
      <div class="question" id="qText">‚ùì ...</div>
      <div id="options"></div>
      <div class="toolbar" style="margin-top:8px">
        <button class="btn secondary" onclick="nextQuestion()">‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ‚ñ∂Ô∏è</button>
      </div>
      <div class="muted">* ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏Å‡πà‡∏≠‡∏ô ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î ‚Äú‡∏ñ‡∏±‡∏î‡πÑ‡∏õ‚Äù ‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏≠‡πÄ‡∏ß‡∏•‡∏≤</div>
    </div>
    <div class="toolbar">
      <button class="btn ghost" onclick="confirmQuit()">üè† ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</button>
    </div>
  </section>

  <!-- RESULT -->
  <section id="screen-result" class="card hidden">
    <h2 class="center">üéâ ‡∏™‡∏£‡∏∏‡∏õ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô üèÜ</h2>
    <div class="card center">
      <p class="big">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏Ç‡∏≠‡∏á <b id="playerFinal">-</b></p>
      <p class="big">‡πÑ‡∏î‡πâ <b id="scoreNum">0</b> / <b id="scoreDen">40</b>  (<b id="scorePct">0%</b>)</p>
      <p id="passNote" class="big" style="font-weight:800;color:var(--good)">‡∏ú‡πà‡∏≤‡∏ô üåü ‡πÄ‡∏Å‡πà‡∏á‡∏°‡∏≤‡∏Å!</p>
      <p id="failNote" class="big hidden" style="font-weight:800;color:var(--bad)">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô (‡πÄ‡∏Å‡∏ì‡∏ë‡πå 80%) üí™</p>
    </div>
    <div class="toolbar center" style="justify-content:center;margin-top:6px">
      <button class="btn" onclick="retryGame()">üîÅ ‡πÄ‡∏•‡πà‡∏ô‡πÉ‡∏´‡∏°‡πà</button>
      <button class="btn ghost" onclick="backToStart()">üè† ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</button>
      <button id="viewAnsBtn" class="btn danger hidden" onclick="showAnswers()">üìó ‡∏î‡∏π‡πÄ‡∏â‡∏•‡∏¢</button>
    </div>
    <p class="muted center" id="attemptInfo"></p>
    <p class="muted center">üå∏ ‡∏™‡∏π‡πâ ‡πÜ ‡∏ô‡∏∞ ‡πÄ‡∏î‡πá‡∏Å ‡πÜ ‡∏ó‡∏≥‡πÑ‡∏î‡πâ! üå∏</p>
  </section>

  <!-- ANSWERS -->
  <section id="screen-answers" class="card hidden">
    <h2>üìó ‡πÄ‡∏â‡∏•‡∏¢‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå 40 ‡∏Ñ‡∏≥</h2>
    <ol id="answerList"></ol>
    <div class="toolbar">
      <button class="btn" onclick="backToStart()">üè† ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</button>
    </div>
  </section>

</div>

<script>
const PASS_RATE = 0.80;
const TIME_PER_Q = 7; // seconds
let player = "";
let current = 0;
let selections = [];
let attemptsMade = 0;
let everFailed = false;
let correctCount = 0;
let timerId = null;
let timeLeft = TIME_PER_Q;

// 40 adjectives with Thai reading and meaning
const VOCABS = [
  ["big","‡∏ö‡∏¥‡πä‡∏Å","‡πÉ‡∏´‡∏ç‡πà"], ["small","‡∏™‡∏°‡∏≠‡∏•","‡πÄ‡∏•‡πá‡∏Å"],
  ["tall","‡∏ó‡∏≠‡∏•","‡∏™‡∏π‡∏á"], ["short","‡∏ä‡∏≠‡∏£‡πå‡∏ï","‡πÄ‡∏ï‡∏µ‡πâ‡∏¢ / ‡∏™‡∏±‡πâ‡∏ô"],
  ["fat","‡πÅ‡∏ü‡∏ó","‡∏≠‡πâ‡∏ß‡∏ô"], ["thin","‡∏ò‡∏¥‡∏ô","‡∏ú‡∏≠‡∏°"],
  ["hot","‡∏Æ‡∏≠‡∏ï","‡∏£‡πâ‡∏≠‡∏ô"], ["cold","‡πÇ‡∏Ñ‡∏•‡∏î‡πå","‡πÄ‡∏¢‡πá‡∏ô"],
  ["fast","‡∏ü‡∏≤‡∏™‡∏ó‡πå","‡πÄ‡∏£‡πá‡∏ß"], ["slow","‡∏™‡πÇ‡∏•‡∏ß‡πå","‡∏ä‡πâ‡∏≤"],
  ["good","‡∏Å‡∏π‡πä‡∏î","‡∏î‡∏µ"], ["bad","‡πÅ‡∏ö‡∏î","‡πÅ‡∏¢‡πà"],
  ["happy","‡πÅ‡∏Æ‡∏õ‡∏õ‡∏µ","‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∏‡∏Ç"], ["sad","‡πÅ‡∏ã‡∏î","‡πÄ‡∏®‡∏£‡πâ‡∏≤"],
  ["young","‡∏¢‡∏±‡∏á","‡∏≠‡∏≤‡∏¢‡∏∏‡∏ô‡πâ‡∏≠‡∏¢"], ["old","‡πÇ‡∏≠‡∏•‡∏î‡πå","‡πÅ‡∏Å‡πà / ‡πÄ‡∏Å‡πà‡∏≤"],
  ["beautiful","‡∏ö‡∏¥‡∏ß‡∏ó‡∏¥‡∏ü‡∏π‡∏•","‡∏™‡∏ß‡∏¢"], ["ugly","‡∏≠‡∏±‡∏Å‡∏•‡∏µ","‡∏Ç‡∏µ‡πâ‡πÄ‡∏´‡∏£‡πà"],
  ["cheap","‡∏ä‡∏µ‡∏û","‡∏ñ‡∏π‡∏Å"], ["expensive","‡πÄ‡∏≠‡πá‡∏Å‡∏ã‡πå‡πÄ‡∏û‡∏ô‡∏ã‡∏¥‡∏ü","‡πÅ‡∏û‡∏á"],
  ["clean","‡∏Ñ‡∏•‡∏µ‡∏ô","‡∏™‡∏∞‡∏≠‡∏≤‡∏î"], ["dirty","‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏ó‡∏µ","‡∏™‡∏Å‡∏õ‡∏£‡∏Å"],
  ["strong","‡∏™‡∏ï‡∏£‡∏≠‡∏á","‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏£‡∏á"], ["weak","‡∏ß‡∏µ‡∏Ñ","‡∏≠‡πà‡∏≠‡∏ô‡πÅ‡∏≠"],
  ["brave","‡πÄ‡∏ö‡∏£‡∏ü","‡∏Å‡∏•‡πâ‡∏≤‡∏´‡∏≤‡∏ç"], ["kind","‡πÑ‡∏Ñ‡∏ô‡∏î‡πå","‡πÉ‡∏à‡∏î‡∏µ"],
  ["polite","‡πÇ‡∏û‡πÑ‡∏•‡∏ó‡πå","‡∏™‡∏∏‡∏†‡∏≤‡∏û"], ["rude","‡∏£‡∏π‡∏î","‡∏´‡∏¢‡∏≤‡∏ö‡∏Ñ‡∏≤‡∏¢"],
  ["funny","‡∏ü‡∏±‡∏ô‡∏ô‡∏µ","‡∏ï‡∏•‡∏Å"], ["boring","‡πÇ‡∏ö‡∏£‡∏¥‡∏á","‡∏ô‡πà‡∏≤‡πÄ‡∏ö‡∏∑‡πà‡∏≠"],
  ["interesting","‡∏≠‡∏¥‡∏ô‡πÄ‡∏ó‡∏≠‡∏∞‡πÄ‡∏£‡∏™‡∏ó‡∏¥‡∏á","‡∏ô‡πà‡∏≤‡∏™‡∏ô‡πÉ‡∏à"], ["noisy","‡∏ô‡∏≠‡∏¢‡∏ã‡∏µ","‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏î‡∏±‡∏á"],
  ["quiet","‡πÑ‡∏Ñ‡∏ß‡πÄ‡∏≠‡πá‡∏ó","‡πÄ‡∏á‡∏µ‡∏¢‡∏ö"], ["hungry","‡∏Æ‡∏±‡∏á-‡∏Å‡∏£‡∏µ","‡∏´‡∏¥‡∏ß"],
  ["thirsty","‡πÄ‡∏ò‡∏¥‡∏™-‡∏ï‡∏µ","‡∏Å‡∏£‡∏∞‡∏´‡∏≤‡∏¢‡∏ô‡πâ‡∏≥"], ["tired","‡πÑ‡∏ó‡πÄ‡∏≠‡∏≠‡∏∞‡∏î","‡πÄ‡∏´‡∏ô‡∏∑‡πà‡∏≠‡∏¢"],
  ["lazy","‡πÄ‡∏•‡∏ã‡∏µ","‡∏Ç‡∏µ‡πâ‡πÄ‡∏Å‡∏µ‡∏¢‡∏à"], ["hard-working","‡∏Æ‡∏≤‡∏£‡πå‡∏î-‡πÄ‡∏ß‡∏¥‡∏£‡πå‡∏Ñ‡∏Å‡∏¥‡∏á","‡∏Ç‡∏¢‡∏±‡∏ô"],
  ["healthy","‡πÄ‡∏Æ‡∏•‡∏ò‡∏µ","‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏î‡∏µ"], ["sick","‡∏ã‡∏¥‡∏Å","‡∏õ‡πà‡∏ß‡∏¢"]
];

const QUESTIONS = VOCABS.map(v => ({ word: v[0], meaning: v[2] }));

function $(id){return document.getElementById(id)}
function show(id){$(id).classList.remove("hidden")}
function hide(id){$(id).classList.add("hidden")}
function switchTo(ids){["screen-start","screen-vocab","screen-rules","screen-quiz","screen-result","screen-answers"].forEach(hide); ids.forEach(show);}
function backToStart(){stopTimer(); switchTo(["screen-start"]);}

function goVocab(){
  // Render vocab table (split two columns)
  const half = Math.ceil(VOCABS.length/2);
  $("vocabCol1").innerHTML = VOCABS.slice(0,half).map(([en,thp,thm])=>`<tr><td>${en}</td><td>${thp}</td><td>${thm}</td></tr>`).join("");
  $("vocabCol2").innerHTML = VOCABS.slice(half).map(([en,thp,thm])=>`<tr><td>${en}</td><td>${thp}</td><td>${thm}</td></tr>`).join("");
  switchTo(["screen-vocab"]);
}

function goRules(){
  const n = $("playerName").value.trim();
  player = n || "Player";
  $("playerLabel").textContent = player;
  switchTo(["screen-rules"]);
}

function startGame(){
  // reset
  selections = Array(QUESTIONS.length).fill(null);
  correctCount = 0;
  current = 0;
  $("qTotal").textContent = QUESTIONS.length;
  renderQuestion();
  switchTo(["screen-quiz"]);
}

function sampleOptions(correct){
  const all = VOCABS.map(v=>v[2]);
  const pool = all.filter(m => m!==correct);
  // shuffle
  for (let i = pool.length-1; i>0; i--){
    const j = Math.floor(Math.random()*(i+1));
    [pool[i], pool[j]] = [pool[j], pool[i]];
  }
  const opts = [correct, ...pool.slice(0,3)];
  // shuffle final
  for (let i=opts.length-1; i>0; i--){
    const j = Math.floor(Math.random()*(i+1));
    [opts[i], opts[j]] = [opts[j], opts[i]];
  }
  return opts;
}

function renderQuestion(){
  stopTimer();
  const q = QUESTIONS[current];
  $("qIndex").textContent = current + 1;
  $("qText").innerHTML = `‚ùì ‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ <b>${q.word}</b> ‡πÅ‡∏õ‡∏•‡∏ß‡πà‡∏≤‡∏≠‡∏∞‡πÑ‡∏£?`;
  const opts = sampleOptions(q.meaning);
  $("options").innerHTML = opts.map(opt=>{
    const id = `opt_${current}_${opt.replace(/\\s/g,'_')}`;
    return `<label><input type="radio" name="q${current}" value="${opt}"> ${opt}</label>`;
  }).join("");
  // start timer
  timeLeft = TIME_PER_Q;
  updateTimerView();
  timerId = setInterval(()=>{
    timeLeft--;
    updateTimerView();
    if(timeLeft<=0){
      stopTimer();
      autoSubmit();
    }
  }, 1000);
}

function updateTimerView(){
  const t = $("timer");
  t.textContent = `‚è±Ô∏è ${timeLeft}`;
  t.classList.toggle("low", timeLeft<=3);
}

function stopTimer(){ if(timerId){ clearInterval(timerId); timerId = null; }}

function autoSubmit(){
  // if nothing selected, mark as wrong (null) and move on
  finalizeQuestion(null);
  if(current < QUESTIONS.length - 1){
    current++; renderQuestion();
  }else{
    finishGame();
  }
}

function nextQuestion(){
  // read selection
  const radios = document.querySelectorAll(`input[name="q${current}"]`);
  let chosen = null;
  radios.forEach(r=>{ if(r.checked) chosen = r.value; });
  finalizeQuestion(chosen);
  if(current < QUESTIONS.length - 1){
    current++; renderQuestion();
  }else{
    finishGame();
  }
}

function finalizeQuestion(choice){
  stopTimer();
  selections[current] = choice;
  if(choice === QUESTIONS[current].meaning){
    correctCount++;
  }
}

function finishGame(){
  const pct = Math.round((correctCount/QUESTIONS.length)*100);
  const passed = (correctCount/QUESTIONS.length) >= PASS_RATE;

  attemptsMade += 1;
  if(!passed){ everFailed = true; }

  $("playerFinal").textContent = player;
  $("scoreNum").textContent = correctCount;
  $("scoreDen").textContent = QUESTIONS.length;
  $("scorePct").textContent = pct + "%";
  $("passNote").classList.toggle("hidden", !passed);
  $("failNote").classList.toggle("hidden", passed);

  // view answers rule
  let canView = false;
  if(attemptsMade === 1 && passed){
    canView = true;
  } else if (everFailed && attemptsMade >= 2){
    canView = true;
  }
  $("viewAnsBtn").classList.toggle("hidden", !canView);

  $("attemptInfo").textContent = canView
    ? (attemptsMade===1 && passed
        ? "‡∏ú‡πà‡∏≤‡∏ô‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å ‚Äî ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Å‡∏î‡∏î‡∏π‡πÄ‡∏â‡∏•‡∏¢‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢"
        : `‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡πÅ‡∏•‡πâ‡∏ß ${attemptsMade} ‡∏Ñ‡∏£‡∏±‡πâ‡∏á (‡πÄ‡∏Ñ‡∏¢‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô) ‚Äî ‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡∏Å‡∏î‡∏î‡∏π‡πÄ‡∏â‡∏•‡∏¢‡πÑ‡∏î‡πâ`)
    : (attemptsMade===1 && !passed
        ? "‡∏¢‡∏±‡∏á‡∏î‡∏π‡πÄ‡∏â‡∏•‡∏¢‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ ‚Äî ‡∏•‡∏≠‡∏á‡∏ó‡∏≥‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏Å‡πà‡∏≠‡∏ô‡∏ô‡∏∞"
        : "‡∏¢‡∏±‡∏á‡∏î‡∏π‡πÄ‡∏â‡∏•‡∏¢‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ");

  switchTo(["screen-result"]);
}

function retryGame(){
  startGame(); // keep attemptsMade / everFailed as is
}

function confirmQuit(){
  if(confirm("‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å‡πÑ‡∏´‡∏°? ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏≠‡∏ö‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å")){ backToStart(); }
}

function showAnswers(){
  const ol = $("answerList");
  ol.innerHTML = "";
  QUESTIONS.forEach((q,idx)=>{
    const li = document.createElement("li");
    const user = selections[idx] ?? "(‡∏´‡∏°‡∏î‡πÄ‡∏ß‡∏•‡∏≤/‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å)";
    const ok = user===q.meaning;
    li.innerHTML = `<b>${q.word}</b> ‚Üí <b>${q.meaning}</b> <br>
      <span class="${ok?'':'muted'}">‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì: <b style="color:${ok?'var(--good)':'var(--bad)'}">${user}</b></span>`;
    ol.appendChild(li);
  });
  switchTo(["screen-answers"]);
}
</script>
</body>
</html>
